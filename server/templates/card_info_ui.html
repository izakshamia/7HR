
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Candidate Profile</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Base backgrounds */
      --bg-primary: #0a0f1f; /* Darker navy for better contrast */
      --card-bg: rgba(26, 32, 54, 0.6); /* Slightly more opaque for better readability */
      --card-border: rgba(255, 215, 0, 0.15); /* Subtle gold border */
      --muted: rgba(255, 255, 255, 0.08); /* More subtle muted elements */

      /* Gold system - refined for better contrast */
      --gold: #ffd700;           /* primary gold */
      --gold-2: #e6c200;         /* slightly darker gold */
      --gold-3: #b8860b;         /* tertiary/bronze */
      --gold-light: #fff176;     /* brighter hover state */
      --gold-weak: rgba(255, 215, 0, 0.08); /* more subtle chip bg */
      --gold-glow: 0 0 15px rgba(255, 215, 0, 0.3); /* gold glow effect */

      /* Text - improved contrast */
      --text-primary: #ffffff;   /* pure white for better readability */
      --text-secondary: #ffd700; /* gold for emphasis */
      --text-muted: #b0b8c5;     /* softer gray for less important text */
      --text-on-gold: #1a2036;   /* dark text on gold elements */

      /* UI Elements */
      --ring: rgba(255, 215, 0, 0.6); /* more visible focus ring */
      --border-subtle: rgba(255, 255, 255, 0.1);
      --border-gold: rgba(255, 215, 0, 0.3);
      --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.4);
      --card-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      --elevation-1: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      --elevation-2: 0 3px 6px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.12);

      /* Transitions */
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-med: 250ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);

      /* Layout */
      --radius-sm: 6px;
      --radius: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;

      /* Spacing */
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing: 1rem;
      --spacing-md: 1.5rem;
      --spacing-lg: 2rem;
      --spacing-xl: 3rem;

      /* Typography */
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      --font-serif: 'Playfair Display', Georgia, serif;
      --font-mono: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      --text-xs: 0.75rem;
      --text-sm: 0.875rem;
      --text-base: 1rem;
      --text-lg: 1.125rem;
      --text-xl: 1.25rem;
      --text-2xl: 1.5rem;
      --text-3xl: 1.875rem;
      --text-4xl: 2.25rem;

      /* Z-index */
      --z-below: -1;
      --z-base: 1;
      --z-docked: 10;
      --z-dropdown: 1000;
      --z-sticky: 1100;
      --z-banner: 1200;
      --z-overlay: 1300;
      --z-modal: 1400;
      --z-popover: 1500;
      --z-toast: 1600;
      --z-tooltip: 1700;
    }

    body {
      background: var(--bg-primary);
      background-image: 
        radial-gradient(at 0% 0%, rgba(255, 215, 0, 0.03) 0px, transparent 50%),
        radial-gradient(at 100% 100%, rgba(26, 32, 54, 0.8) 0px, transparent 50%);
      color: var(--text-primary);
      font-family: var(--font-sans);
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: 1rem;
    }
    .card-container {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      box-shadow: var(--card-shadow), var(--elevation-2);
      backdrop-filter: blur(16px) saturate(180%);
      -webkit-backdrop-filter: blur(16px) saturate(180%);
      animation: card-fade-in 500ms var(--transition-med), fadeIn 0.6s ease-out;
      padding: var(--spacing-xl) var(--spacing-lg);
      max-width: 600px;
      width: min(92vw, 600px);
      display: flex;
      flex-direction: column;
      align-items: center;
      border: 1px solid var(--border-gold);
      position: relative;
      overflow: hidden;
      transition: transform var(--transition-med), box-shadow var(--transition-med);
    }

    .card-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
      opacity: 0.5;
    }
    .headline {
      font-family: 'Playfair Display', serif;
      font-size: 2.1rem;
      color: var(--gold);
      margin: 0.5rem 0 0.2rem;
      text-align: center;
      letter-spacing: 0.02em;
      line-height: 1.2;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    .subtitle {
      color: var(--text-muted);
      font-size: 1.1rem;
      margin: 0.5rem 0 1.5rem;
      text-align: center;
      font-weight: 500;
      line-height: 1.5;
      max-width: 90%;
      margin-left: auto;
      margin-right: auto;
    }
    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.2rem 1.8rem;
      width: 100%;
      margin-bottom: 2rem;
    }
    .info-label {
      color: #ffd700;
      font-size: 0.97rem;
      font-weight: 600;
      letter-spacing: 0.01em;
      margin-bottom: 0.2rem;
      display: flex;
      align-items: center;
    }
    .info-value {
      color: #fffbe6;
      font-size: 0.97rem;
      font-weight: 400;
      margin-bottom: 0.3rem;
    }
    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.25rem;
      letter-spacing: 0.05em;
      color: #ffd700cc;
      margin-top: 1.25rem;
      margin-bottom: 0.7rem;
      text-align: left;
      width: 100%;
    }
    /* Re-using .skills chip style for compact inline groups; main Skills section intentionally removed */
    .skills, .languages, .stack {
      display: flex;
      flex-wrap: wrap;
      gap: 0.45rem 1rem;
      margin-bottom: 0.5rem;
    }
    .skill-chip, .tech-chip {
      background: var(--gold-weak);
      color: var(--gold);
      border-radius: var(--radius-full);
      padding: 0.4rem 1rem;
      font-size: 0.85rem;
      font-weight: 500;
      margin-bottom: 0.4rem;
      border: 1px solid var(--border-gold);
      transition: all var(--transition-med);
      line-height: 1.2;
      display: inline-flex;
      align-items: center;
      position: relative;
      overflow: hidden;
      box-shadow: var(--elevation-1);
    }

    .skill-chip::before, .tech-chip::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), transparent);
      opacity: 0;
      transition: opacity var(--transition-med);
    }
    .skill-chip:hover, .tech-chip:hover {
      background: rgba(255, 215, 0, 0.15);
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      border-color: var(--gold);
    }

    .skill-chip:focus-visible, .tech-chip:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px var(--ring);
      transform: translateY(-1px);
    }
    /* Aliases for React-inspired class names */
    .tech-chip { composes: skill-chip; } /* fallback if 'composes' unsupported, we add a plain alias below */
    .contact-btn-primary {
      background: linear-gradient(90deg, var(--primary), #ffe066);
      color: #232b42;
      border: none;
      box-shadow: 0 2px 12px #ffd70022;
    }
    .contact-btn-ghost {
      background: var(--muted);
      color: var(--secondary-foreground);
      border: 1px solid rgba(255, 215, 0, 0.3);
    }
    .icon {
      width: 1.1em;
      height: 1.1em;
      margin-right: 0.4em;
      stroke: #ffd700;
      vertical-align: middle;
    }
    .divider {
      width: 100%;
      height: 1px;
      background-color: #ffd70033;
      margin: 1.5rem 0;
    }
    .footer {
      margin-top: 2.5rem;
      color: #ffd700cc;
      font-size: 0.95rem;
      letter-spacing: 0.01em;
      text-align: center;
    }
    .footer a {
      margin-top: 0.5rem;
      display: inline-block;
      color: #ffd700;
      text-decoration: underline;
    }
    .avatar {
      border-radius: 50%;
      border: 2px solid #ffd70044;
      background: #232b42;
      width: 80px;
      height: 80px;
    }
    .header-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
      width: 100%;
      margin-bottom: 1.2rem;
      text-align: center;
    }
    .header-details {
      flex: 1;
    }
    .meta-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 1.1rem;
      align-items: center;
      font-size: 1rem;
      color: var(--text-secondary);
      justify-content: center;
      text-align: center;
    }
    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .contact-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 0.75rem;
      margin: 0.5rem 0 1rem;
      width: 100%;
    }

    .contact-actions.header {
      display: flex;
      justify-content: center;
      margin: 1.25rem 0 0.5rem;
      width: 100%;
    }
    
    .contact-actions.header .btn {
      padding: 0.7rem 1.8rem;
      min-width: 180px;
      font-weight: 600;
      letter-spacing: 0.01em;
      border-radius: 8px;
    }
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.7rem 1.4rem;
      border-radius: var(--radius);
      font-weight: 600;
      font-size: 0.95rem;
      text-decoration: none;
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-med);
      width: 100%;
      position: relative;
      overflow: hidden;
      border: none;
      box-shadow: var(--elevation-1);
    }

    .btn::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
      opacity: 0;
      transition: opacity var(--transition-med);
    }

    .btn:hover::after {
      opacity: 1;
    }
    .btn.full { grid-column: 1 / -1; }
    
    /* Header-only contact layout */
    .contact-actions.header {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-top: 0.6rem;
      gap: 0; /* ensure single button centers perfectly */
    }

    /* Allow the header button to be content-width, not full-width */
    .btn.auto { 
      width: auto; 
      padding: 0.7rem 1.4rem; 
    }
    .btn-ghost {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text-primary);
      border: 1px solid var(--border-gold);
      transition: all var(--transition-med), transform 0.2s ease;
    }

    .btn-ghost:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: var(--gold);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .btn-ghost:active {
      transform: translateY(0);
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--gold), var(--gold-2));
      color: var(--text-on-gold);
      font-weight: 600;
      letter-spacing: 0.02em;
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.3);
    }

    .btn-primary:active {
      transform: translateY(0);
    }
    .btn:focus-visible,
    .contact-button:focus-visible,
    .nav-arrow:focus-visible,
    .skill-chip:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px var(--ring);
    }
    .profile-summary {
      background: var(--muted);
      border-radius: 14px;
      padding: 1.1rem 1rem;
      margin-bottom: 1.5rem;
      width: 100%;
    }
    /* Tailwind-like animations */
    @keyframes accordion-down {
      from { height: 0; }
      to   { height: var(--radix-accordion-content-height, auto); }
    }
    @keyframes accordion-up {
      from { height: var(--radix-accordion-content-height, auto); }
      to   { height: 0; }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .animate-fade-in { animation: fadeIn 0.5s ease-out both; }
    .animate-accordion-down { animation: accordion-down 0.2s ease-out both; }
    .animate-accordion-up { animation: accordion-up 0.2s ease-out both; }
    .profile-summary > div:first-child {
      font-family: 'Playfair Display', serif;
      color: #ffd700;
      font-size: 1.15rem;
      margin-bottom: 0.5rem;
      letter-spacing: 0.01em;
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .profile-summary > div:first-child span {
      font-size: 1.2em;
    }
    .profile-summary > div:last-child {
      color: var(--text-primary);
      font-size: 1.04rem;
      line-height: 1.6;
    }
    .profile-summary .skills-container {
      margin-top: 1rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem 1rem;
    }
    .experience-timeline {
      position: relative;
      padding-left: 2rem;
      margin: 1.5rem 0 2.5rem;
    }
    
    .experience-timeline::before {
      content: '';
      position: absolute;
      left: 1px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(to bottom, transparent, var(--border-gold), transparent);
      opacity: 0.5;
    }
    .experience-item {
      position: relative;
      padding: 1.5rem 1.75rem 1.5rem 2.75rem;
      border-left: 2px solid var(--border-gold);
      margin-bottom: 1.75rem;
      background: rgba(255, 255, 255, 0.02);
      border-radius: 0 14px 14px 0;
      transition: all var(--transition-med);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .experience-item:hover {
      transform: translateX(4px);
      background: rgba(255, 255, 255, 0.03);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    .experience-item::before {
      content: "";
      position: absolute;
      left: -0.15rem;
      top: 0.35rem;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ffd700cc;
      box-shadow: 0 0 0 3px #ffd70022;
    }

    /* Experience header layout & hierarchy */
    .exp-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1rem;
      width: 100%;
      margin-bottom: 0.5rem;
    }
    .exp-role-company{
      flex:1 1 auto;
      min-width:0;
    }
    .exp-title {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1.4;
      margin: 0 0 0.3rem 0;
      letter-spacing: -0.01em;
      transition: color var(--transition-med);
    }
    
    .experience-item:hover .exp-title {
      color: var(--gold);
    }
    .exp-company {
      color: var(--gold);
      font-weight: 500;
      line-height: 1.3;
      font-size: 0.95rem;
      opacity: 0.9;
    }
    .exp-dates {
      flex: 0 0 auto;
      min-width: 140px;
      text-align: right;
      font-size: 0.9rem;
      line-height: 1.3;
    }
    .exp-period {
      color: var(--text-primary);
      font-weight: 500;
      white-space: nowrap;
    }
    .exp-tenure {
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: 0.1rem;
    }
    /* Description & toggle */
    .exp-desc{
      color: var(--muted-foreground);
      font-size:1.05rem;
    }
    .toggle-label{
      color: var(--accent);
      font-weight:600;
    }
    /* Toggle control (Show more / Show less) for collapsibles */
    .exp-toggle {
      position: absolute;
      opacity: 0;
      width: 1px;
      height: 1px;
      pointer-events: none; /* visually hidden but still toggleable via label */
    }
    .exp-toggle + label.toggle-label {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      cursor: pointer;
      color: var(--gold);
      font-weight: 600;
      margin: 0.25rem 0 0.5rem;
      user-select: none;
    }
    .exp-toggle + label.toggle-label::before { content: "▾"; }
    .exp-toggle + label.toggle-label::after { content: "Show more"; }
    .exp-toggle:checked + label.toggle-label::before { content: "▴"; }
    .exp-toggle:checked + label.toggle-label::after { content: "Show less"; }
    .muted {
      color: #e0dcc2;
      opacity: 0.85;
      font-size: 0.95rem;
    }
    @media (max-width: 600px) {
      .card-container {
        padding: 1rem 0.3rem;
        border-radius: 10px;
      }
      .headline {
        font-size: 1.4rem;
      }
      .info-grid {
        grid-template-columns: 1fr;
        gap: 0.7rem 0;
      }
    }
    .exp-desc {
      color: var(--text-muted);
      line-height: 1.7;
      margin: 1rem 0 0.25rem;
      font-size: 1.02rem;
      position: relative;
    }
    
    .exp-desc p {
      margin: 0.5em 0;
    }
    
    .exp-desc p:first-child {
      margin-top: 0;
    }
    
    .exp-desc p:last-child {
      margin-bottom: 0;
    }

    /* Generic collapsible container for chip groups */
    .collapsible {
      max-height: 64px; /* ~2 rows of chips */
      overflow: hidden;
      position: relative;
    }
    .collapsible::after {
      content: "";
      position: absolute;
      left: 0; right: 0; bottom: 0;
      height: 36px;
      background: linear-gradient(to bottom, rgba(23,31,50,0) 0%, rgba(23,31,50,0.98) 70%, rgba(23,31,50,1) 100%);
      pointer-events: none;
    }
    .exp-toggle:checked ~ .collapsible {
      max-height: none;
    }
    .exp-toggle:checked ~ .collapsible::after { display: none; }

    /* Navigation arrows */
    .nav-arrow {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: rgba(16, 24, 42, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: 1px solid var(--border-gold);
      transition: all var(--transition-med);
      z-index: var(--z-popover);
      color: var(--gold);
      text-decoration: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      opacity: 0.8;
    }
    .nav-arrow:hover {
      background: rgba(255, 215, 0, 0.15);
      transform: translateY(-50%) scale(1.1);
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.25);
      opacity: 1;
    }

    .nav-arrow:active {
      transform: translateY(-50%) scale(0.95);
    }

    .nav-arrow:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px var(--ring);
    }

    .nav-arrow[aria-disabled="true"] {
      opacity: 0.2;
      pointer-events: none;
    }

    .nav-arrow svg {
      width: 22px;
      height: 22px;
      stroke: currentColor;
      stroke-width: 2.5px;
      transition: transform var(--transition-fast);
    }

    .nav-left {
      left: 16px;
      padding-right: 2px;
    }

    .nav-right {
      right: 16px;
      padding-left: 2px;
    }

    @media (max-width: 480px) {
      .nav-arrow {
        width: 40px;
        height: 40px;
      }
      
      .nav-arrow svg {
        width: 20px;
        height: 20px;
      }
      
      .nav-left { left: 12px; }
      .nav-right { right: 12px; }
    }

    @media (max-width: 600px) {
      .nav-arrow { width: 44px; height: 44px; }
      .nav-arrow svg { width: 22px; height: 22px; }
      .nav-left { left: 10px; }
      .nav-right { right: 10px; }
    }

    /* section order accent */
    .section-title:first-of-type { margin-top: 0.5rem; }

    @media (max-width: 600px) {
      .header-section { flex-direction: column; align-items: flex-start; gap:0.8rem; }
      .contact-actions { gap:0.6rem; font-size:0.95rem; }
      .skill-chip { padding: 0.28rem 0.75rem; }
    }
  </style>
</head>
<body {% if nav and nav.prev %}data-prev="{{ nav.prev }}"{% endif %} {% if nav and nav.next %}data-next="{{ nav.next }}"{% endif %} data-testid="page-root">
  <!-- NAVIGATION -->
  {% if nav and (nav.prev or nav.next) %}
    {% if nav.prev %}
      <a class="nav-arrow nav-left" href="{{ nav.prev }}" aria-label="Previous candidate" data-testid="nav-prev">
        <svg viewBox="0 0 24 24" fill="none"><path d="M15 19l-7-7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </a>
    {% else %}
      <span class="nav-arrow nav-left" aria-disabled="true" aria-label="No previous candidate" data-testid="nav-prev">
        <svg viewBox="0 0 24 24" fill="none"><path d="M15 19l-7-7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </span>
    {% endif %}

    {% if nav.next %}
      <a class="nav-arrow nav-right" href="{{ nav.next }}" aria-label="Next candidate" data-testid="nav-next">
        <svg viewBox="0 0 24 24" fill="none"><path d="M9 5l7 7-7 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </a>
    {% else %}
      <span class="nav-arrow nav-right" aria-disabled="true" aria-label="No next candidate" data-testid="nav-next">
        <svg viewBox="0 0 24 24" fill="none"><path d="M9 5l7 7-7 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </span>
    {% endif %}
  {% endif %}
  
  <!-- MACROS -->
  {% macro initials(name) -%}
    {%- set n = (name or '').strip() -%}
    {%- if n -%}
      {%- set parts = n.split(' ') -%}
      {%- set first = parts[0][:1] -%}
      {%- set last = (parts|length > 1) and parts[-1][:1] or '' -%}
      {{ (first ~ last).upper() }}
    {%- endif -%}
  {%- endmacro %}

  {% macro tenure(start, end) -%}
    {%- set s = (start or '')[:7] -%}
    {%- set e = (end or '')[:7] -%}
    {%- if s and e -%}
      {%- set sy = s[:4]|int -%}
      {%- set sm = s[5:7]|int -%}
      {%- set ey = e[:4]|int -%}
      {%- set em = e[5:7]|int -%}
      {%- set months = (ey - sy) * 12 + (em - sm) -%}
      {%- set yrs = (months // 12) -%}
      {%- set mos = (months % 12) -%}
      {%- set parts = [] -%}
      {%- if yrs > 0 -%}{%- set _ = parts.append(yrs ~ ' yr' ~ ('s' if yrs>1 else '')) -%}{%- endif -%}
      {%- if mos > 0 -%}{%- set _ = parts.append(mos ~ ' mo') -%}{%- endif -%}
      {%- if parts -%} ({{ parts|join(' ') }}){%- endif -%}
    {%- endif -%}
  {%- endmacro %}

  {% macro fmt_date(d) -%}
    {%- set s = (d or '')[:7] -%}
    {%- if s -%}
      {%- set y = s[:4] -%}
      {%- set mi = s[5:7]|int -%}
      {%- set months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'] -%}
      {{ months[mi-1] }} {{ y }}
    {%- else -%}
    {%- endif -%}
  {%- endmacro %}
  
  <div class="card-container">
    <!-- HEADER SECTION -->
    <div class="header-section" data-testid="header-section">
      {% if c.candidate.avatarUrl %}
        <img src="{{ c.candidate.avatarUrl }}" alt="Avatar" class="avatar">
      {% else %}
        <svg class="avatar" viewBox="0 0 80 80" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0%" stop-color="#ffd700"/>
              <stop offset="70%" stop-color="#d4af37"/>
              <stop offset="100%" stop-color="#b8860b"/>
            </linearGradient>
          </defs>
          <circle cx="40" cy="40" r="38" fill="url(#g)" stroke="#ffd70044" stroke-width="2"/>
          <text x="50%" y="54%" dominant-baseline="middle" text-anchor="middle" fill="#10182a" font-size="28" font-weight="700" font-family="Inter, Arial, sans-serif">{{ initials(c.candidate.fullName) }}</text>
        </svg>
      {% endif %}
      <div class="header-details">
        <div class="headline">{{ c.candidate.fullName }}</div>
        <div class="meta-tags">
          <span class="meta-item">• {{ c.candidate.primaryProfession }}</span>
          <span class="meta-item">• {{ c.candidate.location }}</span>
          <span class="meta-item">• {{ c.candidate.seniority }}</span>
        </div>
      </div>
      {% set contact_url = c.candidate.contactLink or c.candidate.telegram or (c.candidate.linkedin and 'https://www.linkedin.com/in/' ~ c.candidate.linkedin) or (c.candidate.email and 'mailto:' ~ c.candidate.email) or 'https://t.me/workwithgoodbot' %}
      <div class="contact-actions header">
        <a class="btn btn-primary auto" href="{{ contact_url }}" target="_blank" rel="noopener" aria-label="Contact" data-testid="button-contact-primary">
          <svg viewBox="0 0 24 24" fill="none" width="20" height="20" aria-hidden="true" style="margin-right:.5rem">
            <rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2"/>
            <path d="M3 6l9 7 9-7" stroke="currentColor" stroke-width="2"/>
          </svg>
          Contact
        </a>
      </div>
    </div>
    <div class="divider"></div>

    <!-- PROFILE SUMMARY SECTION -->
    {% if c.candidate.summary %}
    <div class="profile-summary">
      <div>Profile Summary <span>✨</span></div>
      <div>{{ c.candidate.summary }}</div>
    </div>
    <div class="divider"></div>
    {% endif %}

    <!-- EXPERIENCE TIMELINE SECTION -->
    {% if c.experience %}
    <div class="section-title">Experience</div>
    <div class="experience-timeline">
      {% for exp in c.experience %}
        <div class="experience-item">
          <div class="exp-header">
            <div class="exp-role-company">
              <h3 class="exp-title">{{ exp.title }}</h3>
              <div class="exp-company">{{ exp.companyName }}</div>
            </div>
            <div class="exp-dates">
              <div class="exp-period">{{ fmt_date(exp.startDate) }} - {{ fmt_date(exp.endDate) or 'Present' }}</div>
              <div class="exp-tenure">{{ tenure(exp.startDate, exp.endDate) }}</div>
            </div>
          </div>
          {% if exp.description %}
            <div class="exp-desc" data-testid="experience-description">{{ exp.description }}</div>
          {% endif %}
          {% set role_chips = exp.techStack if exp.techStack else (exp.skills if exp.skills else []) %}
          {% if role_chips %}
      {% set total_role_chips = role_chips|length %}
      <div class="skills" aria-label="Role Skills" style="margin-top:0.35rem;">
        {% for t in role_chips[:8] %}
          {% if t %}<span class="skill-chip">{{ t }}</span>{% endif %}
        {% endfor %}
        {% if total_role_chips > 8 %}
          <span class="skill-chip" aria-label="More technologies">+{{ total_role_chips - 8 }} more</span>
        {% endif %}
      </div>
    {% endif %}
        </div>
      {% endfor %}
    </div>
    <div class="divider"></div>
    {% endif %}

    <!-- SKILLS SECTION -->
    {# Build sets for profile skills vs experience tech stack #}
    {% set prof_ns = namespace(raw=[], lower_to_display={}) %}
    {% for s in c.skills or [] %}
      {% set n = (s.name or '') %}
      {% if n %}
        {% set lower = n|lower %}
        {% if lower not in prof_ns.lower_to_display %}
          {% set _ = prof_ns.raw.append(lower) %}
          {% set _ = prof_ns.lower_to_display.update({lower: n ~ (s.level and ' (' ~ s.level ~ ')' or '')}) %}
        {% endif %}
      {% endif %}
    {% endfor %}

    {% set exp_ns = namespace(items=[]) %}
    {% for exp in c.experience or [] %}
      {% for t in exp.techStack or [] %}
        {% if t and (t|lower) not in exp_ns.items %}
          {% set _ = exp_ns.items.append(t|lower) %}
        {% endif %}
      {% endfor %}
    {% endfor %}

    {# Compute missing skills: in profile but not in any experience techStack #}
    {% set missing = [] %}
    {% for lk in prof_ns.raw %}
      {% if lk not in exp_ns.items %}
        {% set _ = missing.append(lk) %}
      {% endif %}
    {% endfor %}

    {# Render a minimal inline disclosure ONLY if there are missing skills #}
    {% if missing %}
      <div class="section-title">Additional Skills</div>
      {% set uid_m = 'more_skills' %}
      <input id="{{ uid_m }}" type="checkbox" class="exp-toggle" />
      <label for="{{ uid_m }}" class="toggle-label"></label>
      <div class="skills collapsible" aria-label="Additional Skills" style="margin-top:0.35rem;">
        {% for lk in missing %}
          <span class="skill-chip" style="opacity:0.9;">{{ prof_ns.lower_to_display[lk] }}</span>
        {% endfor %}
      </div>
      <div class="divider"></div>
    {% endif %}

    {# Tech Stack (aggregate across all experiences, unique) #}
    {% set stack_ns = namespace(items=[]) %}
    {% for exp in c.experience or [] %}
      {% for t in exp.techStack or [] %}
        {% if t and t not in stack_ns.items %}
          {% set _ = stack_ns.items.append(t) %}
        {% endif %}
      {% endfor %}
    {% endfor %}
    {% if stack_ns.items %}
      <div class="section-title">Tech Stack</div>
      <div class="stack">
        {% for tech in stack_ns.items %}<span class="skill-chip">{{ tech }}</span>{% endfor %}
      </div>
      <div class="divider"></div>
    {% endif %}

    <!-- EDUCATION SECTION -->
    {% set valid_edu = [] %}
    {% for edu in c.education or [] %}
      {% set degree = edu.degreeType or '' %}
      {% set field = edu.fieldOfStudy or '' %}
      {% set inst = edu.institution or edu.universityName or '' %}
      {% set grad = edu.graduationYear %}
      {% if degree and degree|lower != 'none' and inst and inst|lower != 'none' %}
        {% set _ = valid_edu.append({
          'degree': degree,
          'field': field,
          'inst': inst,
          'grad': grad
        }) %}
      {% endif %}
    {% endfor %}

    {% if valid_edu %}
      <div class="section-title">Education</div>
      <div class="education-section">
        {% for e in valid_edu %}
          <div class="education-item" style="margin-bottom:0.6rem;">
            <div class="info-value"><strong>{{ e.degree }}</strong>{% if e.field %} in {{ e.field }}{% endif %}</div>
            <div class="info-value muted">{{ e.inst }}{% if e.grad %} • Class of {{ e.grad }}{% endif %}</div>
          </div>
        {% endfor %}
      </div>
      <div class="divider"></div>
    {% endif %}

    <!-- LANGUAGES SECTION -->
    {% if c.languages %}
      <div class="section-title">Languages</div>
      <div class="languages">
        {% for lang in c.languages %}
          {% if lang.name %}<span class="skill-chip">{{ lang.name }}{% if lang.proficiency %} ({{ lang.proficiency }}){% endif %}</span>{% endif %}
        {% endfor %}
      </div>
      <div class="divider"></div>
    {% endif %}

    <!-- CONTACT SECTION -->
    <div class="section-title">Contact</div>
    <div class="contact-section">
      {% set contact_info = {
        'phone': c.candidate.phone,
        'email': c.candidate.email,
        'linkedin': c.candidate.linkedin,
        'github': c.candidate.github,
        'portfolio': c.candidate.portfolio,
        'resume': c.candidate.resume,
        'telegram': c.candidate.telegram
      } %}
      <div class="contact-actions">
        {% if contact_info.phone %}
        <a href="tel:{{ contact_info.phone }}" class="btn btn-ghost" aria-label="Call {{ contact_info.phone }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-phone mr-2" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
          <span>Call</span>
        </a>
        {% endif %}
        
        {% if contact_info.email %}
        <a href="mailto:{{ contact_info.email }}" class="btn btn-ghost" aria-label="Email {{ contact_info.email }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail mr-2" aria-hidden="true"><rect x="2" y="4" width="20" height="16" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
          <span>Email</span>
        </a>
        {% endif %}
        
        {% if contact_info.linkedin %}
        <a href="{{ contact_info.linkedin }}" target="_blank" rel="noopener noreferrer" class="btn btn-ghost" aria-label="LinkedIn Profile">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="lucide lucide-linkedin mr-2" aria-hidden="true"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg>
          <span>LinkedIn</span>
        </a>
        {% endif %}
        
        {% if contact_info.github %}
        <a href="{{ contact_info.github }}" target="_blank" rel="noopener noreferrer" class="btn btn-ghost" aria-label="GitHub Profile">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github mr-2" aria-hidden="true"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg>
          <span>GitHub</span>
        </a>
        {% endif %}
        
        {% if contact_info.portfolio %}
        <a href="{{ contact_info.portfolio }}" target="_blank" rel="noopener noreferrer" class="btn btn-ghost" aria-label="Portfolio">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link mr-2" aria-hidden="true"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
          <span>Portfolio</span>
        </a>
        {% endif %}
        
        {% if contact_info.resume %}
        <a href="{{ contact_info.resume }}" target="_blank" rel="noopener noreferrer" class="btn btn-ghost" aria-label="View Resume">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-2" aria-hidden="true"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><line x1="10" y1="9" x2="8" y2="9"></line></svg>
          <span>Resume</span>
        </a>
        {% endif %}
        
        {% if contact_info.telegram %}
        <a href="https://t.me/{{ contact_info.telegram }}" target="_blank" rel="noopener noreferrer" class="btn btn-ghost" aria-label="Telegram">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="lucide lucide-send-horizontal mr-2" aria-hidden="true"><path d="m3 3 3 9-3 9 19-9Z"></path><path d="M6 12h16"></path></svg>
          <span>Telegram</span>
        </a>
        {% endif %}
      </div>

      <!-- FOOTER SECTION -->
      <div class="footer">
        <svg class="icon" viewBox="0 0 24 24" fill="none"><path d="M12 2v20M2 12h20" stroke-width="2"/></svg>
        <span style="opacity:.85">Profile generated by Telegram CV Bot • Premium Community Platform</span>
      </div>
</div>  
</div>

  <!-- SCRIPTS SECTION -->
  <script>
    (function(){
      var prev = document.body.getAttribute('data-prev');
      var next = document.body.getAttribute('data-next');
      document.addEventListener('keydown', function(e){
        if (e.key === 'ArrowLeft' && prev) { window.location.href = prev; }
        if (e.key === 'ArrowRight' && next) { window.location.href = next; }
      });
    })();
  </script>
</body>
</html>
